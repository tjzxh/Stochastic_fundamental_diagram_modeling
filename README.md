The official code for article \
**On the stochastic fundamental diagram: A general micro-macroscopic traffic flow modeling framework**
https://doi.org/10.1016/j.commtr.2025.100163

![image](https://github.com/user-attachments/assets/6244bcb9-83f5-424b-8183-b468a0c37753)

Bridging Microscopic Interactions and Macroscopic Traffic Patterns: A Novel Approach to Stochastic Fundamental Diagram Modeling 
 

Traffic congestion and its inherent stochasticity continue to challenge urban mobility worldwide. Addressing this, researchers have introduced a groundbreaking framework for modeling the Stochastic Fundamental Diagram (SFD), a tool essential for understanding the stochasticity in traffic flow and developing more reliable traffic control strategies.  

The newly proposed Leader-Follower Conditional Distribution-based Stochastic Traffic Modeling (LFCD-STM) framework bridges the gap between microscopic driver interactions and macroscopic traffic flow patterns. By introducing a probabilistic representation of leader-follower behavior and leveraging the Markov chain principle, the framework derives analytical functions describing traffic flow's mean and variance under equilibrium conditions.  

Validated using NGSIM I-80, US-101, and HighD datasets, the results demonstrate high consistency with real-world data. Applications of this framework span real-time traffic flow estimation, enhanced simulation of macroscopic traffic dynamics, and development of robust traffic control strategies that account for uncertainty.  

The implications are profound: from providing traffic engineers with tools for better policy-making to promoting smoother driving behaviors for congestion mitigation. Furthermore, as connected and automated vehicles (CAVs) continue to evolve, this analytical model offers a foundation for optimizing mixed traffic systems and developing efficient CAV control strategies.  

This research paves the way for more efficient, sustainable, and adaptive traffic management systems, addressing long-standing challenges in transportation engineering.


微观与宏观的完美衔接：新方法助力随机交通流基本图的建模 
 

交通流存在内生的随机性，此随机性来自微观车辆之间的交互，与交通运行效率息息相关。为理解根生于微观行为的宏观不确定性，研究团队提出了一种全新的随机交通流基本图建模框架，为开发可靠的交通控制策略及高效的自动驾驶算法奠定了理论基础。

这一基于前后车条件分布的随机交通流建模（Leader-Follower Conditional Distribution-based Stochastic Traffic Modeling, LFCD-STM）框架定义了基于布朗运动的条件概率分布，以描述前后车的微观交互。通过将车队建模为马尔可夫链，框架进一步得到车队速度联合分布，并最终推导出平衡条件下流量-密度基本图的平均值和方差，从而在理论上连接了微观驾驶行为与宏观交通流特征尤其是随机性。在NGSIM I-80、US-101和HighD数据集下的验证表明，该方法有效地复现了随机基本图的主要特征，与实际观测数据表现出高度一致性。

这一框架可用于基本图预测，交通流仿真以及设计更鲁棒性的交通控制策略。同时，这一宏微观结合的模型能有效指导微观驾驶行为，以缓解交通拥堵。例如，通过动态信息屏发布“平稳驾驶、避免急刹”信息，以及在驾校培训中强调平稳加速与减速的重要性，均有助于培养有助于系统效率提升的驾驶习惯。此外，随着网联自动驾驶车辆（CAV）的发展，该模型在混合交通流分析及CAV控制策略开发中亦具有重要应用价值。 

该研究为未来构建更高效、更可持续、更具适应性的交通管理系统奠定了坚实基础，为破解交通领域长期存在的难题提供了新思路。
